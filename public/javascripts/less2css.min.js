/* less2css - v0.0.7 - http://less2css.org/
 * Copyright (c) 2013 Brian Frichette. All rights reserved.
 * Licensed MIT - http://opensource.org/licenses/MIT
 */
!function(){function a(a){var c=b.documentElement.style;if(a in c)return a;var d=["Webkit","Moz","O","ms"],e=d.length,f=0;for(a=a.charAt(0).toUpperCase()+a.slice(1);e>f;){var g=d[f]+a;if(g in c)return g;f++}return a.toLowerCase()}{var b=document,c={transform:a("transform"),transition:a("transition"),transitionDuration:a("transitionDuration")};!function(){var a={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd"};return a[c.transition]}()}_.extend(Element.prototype,{hasClosestEl:function(a){for(var b=this;b.parentElement;){if(b===a)return!0;b=b.parentElement}return!1},getComputedStyle:function(a){return window.getComputedStyle(this)[a]},childElements:function(a){for(var b=this.querySelectorAll(a),c=[].slice.call(this.children),d=[],e=b.length,f=0;e>f;)-1!==c.indexOf(b[f])&&d.push(b[f]),f++;return d.length?d:null},slide:function(){return{direction:"left",speed:"500ms",easing:"ease-out"}}})}(),angular.module("Less2Css",[]).config(["$provide",function(a){a.decorator("$rootScope",["$delegate",function(a){return a.$safeApply=function(){var b,c,d=arguments,e=(d.length,!1);switch(d.length){case 1:var f=d[0];_.isFunction(f)?c=f:b=f;break;case 3:e=!!d[2];case 2:b=d[0],c=d[1]}b=b||a,c=c||_.noop,e||!b.$$phase?b.$apply?b.$apply(c):b.apply(c):c()},a}])}]),function(){function a(a,b){this._ls=window.localStorage,this._key=a,this._exp=b||null,this._update()}a.prototype={get:function(){return this._data},set:function(a){var b=JSON.stringify({data:a,expires:this._exp});return this._ls.setItem(this._getkey(),b),this._update()},remove:function(){return this._remove(),this._update()},_getkey:function(a){return a||"__stor__"+(this._key||"")},_get:function(){return JSON.parse(this._ls.getItem(this._getkey()))},_update:function(){var a=this._get();return a?(null!==a._exp&&a._exp<=this._exp&&this.remove(),this._data=a.data,this._exp=a.exp||this._exp,this._data):(this._exp=this._exp||null,this.set(null))},_remove:function(a){this._ls.removeItem(this._getkey(a))}},angular.module("Less2Css").constant("Storage",a)}(),angular.module("Less2Css").factory("Stor",["$q","$rootScope","$timeout","Storage",function(a,b,c,d){return _.extend(d.prototype,{getAsync:function(){var d=arguments[0],e=([].slice.call(arguments,1),a.defer()),f=this;return c(function(){var a=f.get.call(f);if(a)b.safeApply(function(){e.resolve({data:a,type:"local"})});else{var c=d(),g={type:"xhr"};c.then(function(a){return b.safeApply(function(){g.data=a.data,g.status=a.status,e.resolve(g)})})}},1),e.promise}}),d}]),angular.module("Less2Css").factory("LessOptions",["$q","$http","Stor",function(a,b,c){function d(){function a(a){_.extend(b.options,a)}var b=this;b.options={},b.request=f,b.setCache=function(a){var b=g.get();b.options=a,g.set(b)},f.then(a)}var e=a.defer(),f=e.promise,g=new c("LessOptions",{expires:31536e6}),h=g.get();return h&&h.defaults?e.resolve(h.options||h.defaults):b.get("/less-options").success(function(a){e.resolve(a),g.set({defaults:a})}),new d}]),angular.module("Less2Css").factory("LessCompiler",["Stor",function(a){function b(){this.options={saveLess:!0,lessPath:"/javascripts/less/less-{version}.js"},this.storage=c}var c=new a("LessEditorCache");return b.prototype={initLess:function(){this.parser=new less.Parser(this.lessOptions)},loadLess:function(){window.less=void 0;var a=this.options,b=this.lessOptions,c=b.selectedVersion;c="pre"===b.version?c+"-beta":c;var d=a.lessPath.replace("{version}",c);return $.ajax({url:d,cache:!0,dataType:"script"})},compileLess:function(a){if(!this.parser)return"";try{var b=this.parseLess(a,this.lessOptions);return this.error=!1,this.storage.set(a),b}catch(c){return this.error=!0,"file"===c.type.toLowerCase()&&this.initLess(),this.updateError(c)}},parseLess:function(a){var b=this.lessOptions,c="";return this.parser.parse(a,function(a,d){if(a)throw a;c=d.toCSS(b)}),c},updateOptions:function(a){this.lessOptions=a,window.less&&this.initLess()},updateError:function(a){var b=a.type+" error: "+a.message+"\n"+(a.extract&&a.extract.join&&a.extract.join(""));return b},getCache:function(){return this.storage.get()}},new b}]),angular.module("Less2Css").service("TransitionHelper",["$window","$document",function(a,b){function c(a){var c=b.documentElement.style;if(a in c)return a;var d=["Webkit","Moz","O","ms"],e=d.length,f=0;for(a=a.charAt(0).toUpperCase()+a.slice(1);e>f;){var g=d[f]+a;if(g in c)return g;f++}return a.toLowerCase()}function d(a){return"number"!=typeof a||isNaN(a)?a:a+"px"}function e(a){var b=/[\d\.\-]+/g,c=a.match(b),d=c.length>6,e=d?c[14]:c[5],f=d?c[13]:c[4];return{X:parseFloat(f),Y:parseFloat(e)}}b=b[0];var f=this.props={transform:c("transform"),transition:c("transition"),transitionDuration:c("transitionDuration")};this.translate=function(a,b,c){var g=a.getComputedStyle(f.transform),h=d("X"===c?b:e(g).X),i=d("Y"===c?b:e(g).Y);a.style[f.transform]="translate3d("+h+","+i+",0)"},this.translateX=function(a,b){this.translate(a,b,"X")},this.translateY=function(a,b){this.translate(a,b,"Y")},this.transition=function(a,b){a.style[f.transition]=b},this.transitionDuration=function(a,b){a.style[f.transitionDuration]=b},this.transitionEnd=function(){var a={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd"};return a[f.transition]}()}]),angular.module("Less2Css").directive("fadeShow",function(){function a(a,b,c){function d(a,b){null==b&&(b=!1),a?e.fadeIn(g):b?e.hide():e.fadeOut(g)}var e=$(b),f=c.fadeShow,g=400;d(a.$eval(f),!0),a.$watch(function(){return a.$eval(f)},function(a){d(a)})}return a}),angular.module("Less2Css").directive("lessEditor",["LessOptions",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){function f(){var a=b.opts.lessEditorOptions,d=CodeMirror.fromTextArea(c[0],a);d.on("change",g(a.onChange)),e.$render=function(){d.setValue(e.$viewValue)}}function g(){return function(a){var c=a.getValue();c!==e.$viewValue&&(e.$setViewValue(c),b.$apply())}}b.opts=a.options,e.$setViewValue(b.$eval(d.ngModel)||c[0].value),e.$render(),a.request.then(f)}}}]),angular.module("Less2Css").directive("drawer",["TransitionHelper",function(a){return{replace:!0,restrict:"E",transclude:!0,templateUrl:"drawer.html",scope:{open:"=",opts:"=",offset:"=",position:"="},link:function(b,c){function d(c){e();var d=c?b.offset:-b.height+parseInt(b.offset,10);a["translate"+g](b.el,d),f.style.opacity=c?1:0}function e(){b.height=b.el.offsetHeight,b.width=b.el.offsetWidth}var f=b.el=c[0],g="top"===b.position||"bottom"===b.position?"Y":"X";b.$watch("open",d)}}}]),angular.module("Less2Css").controller("AppCtrl",["$scope","LessOptions",function(a,b){a.opts=b.options,a.toggleDrawer=function(b){b.preventDefault(),a.drawerOpen=!a.drawerOpen}}]),angular.module("Less2Css").controller("OptionsCtrl",["$scope","LessOptions",function(a,b){function c(){_.defaults(h,h.options),h.lineNumbers=h.lineNumbers||h.lineNumberOptions[0].value,d()}function d(){h.selectedVersion=h.selectedVersion||_.find(h.versions,function(a){return"current"===a.type}).number}function e(){h.dumpLineNumbers=h.lineNumbersEnabled&&h.lineNumbers?h.lineNumbers:!1}function f(){h.rootpath=h.rootPathEnabled&&h.rootpathText?h.rootpathText:!1}function g(a){h.version=_.find(h.versions,function(b){return b.number===a})}var h=a.opts=b.options;b.request.then(c),a.toggleOption=function(a){h[a]=!h[a]},a.toggleTxt=function(a){return h[a]?"Enabled":"Disabled"},a.$watch("opts.lineNumbers+opts.lineNumbersEnabled",e),a.$watch("opts.rootpathText+opts.rootpath",f),a.$watch("opts.selectedVersion",g)}]),angular.module("Less2Css").controller("Less2CssCtrl",["$http","$scope","LessCompiler","LessOptions",function(a,b,c,d){function e(){b.opts=d.options,f(b.opts),b.$watch("lessInput",h),b.$watch("opts.selectedVersion",g),b.$watch("opts",f,!0)}function f(a){c.updateOptions(a),d.setCache(a),h()}function g(){b.loading=!0;var a=c.loadLess();a.done(function(){b.$apply(function(){c.initLess(),h(),b.loading=!1})})}function h(){b.$safeApply(function(){_.extend(b,{cssOutput:c.compileLess(b.lessInput),compileError:c.error})})}d.request.then(e),_.extend(b,{lessInput:c.getCache(),cssOutput:"",loading:!1,compileError:!1})}]);